<?xml version="1.0" encoding="UTF-8"?>
<con:testCase failOnError="true" failTestCaseOnErrors="true" id="78028b99-9b83-4ea7-97ce-703e16fe56bf" keepSession="false" maxResults="0" name="TestCase - Invalid Search" searchProperties="true" xmlns:con="http://eviware.com/soapui/config">
  <con:description>Another batch of TestCases that we want to fail?

                These tests expands on what we did with "TestCase - Invalid Login" and shows some important test that
                you always should have.

                1) If you have a Web Service that depends on logging in, always make sure that nothing can be done
                wothout logging in. Don't make one test, make several.
                2) If you have a Web Service that depends on logging in, create a number of test with the user logged
                in.
                3) Create SQL injections test. Sure this should not never ever happend, but it does... And when it does
                it is bad. It is easy to create with ReadyAPI Test and will make you sleep easier at night.
                4) Always test what happends when you try to make a call quickly after logging out.</con:description>
  <con:settings>
    <con:setting id="78028b99-9b83-4ea7-97ce-703e16fe56bffileName">TestCase---Invalid-Search</con:setting>
  </con:settings>
  <con:testStep id="f3e10730-0767-4cb6-aea4-49f80541dcc2" name="Start Virt Service" type="VirtRunnerTestStep">
    <con:settings/>
    <con:config>
      <url>localhost</url>
      <server>ServiceSoapBinding MockService</server>
      <action>run</action>
    </con:config>
  </con:testStep>
  <con:testStep id="77b0d965-5996-4d1c-839e-fae1d0af444a" name="Properties - Correct Session Property" type="properties">
    <con:settings/>
    <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:properties>
        <con:property>
          <con:name>Session</con:name>
          <con:value>29711622719335506</con:value>
        </con:property>
      </con:properties>
    </con:config>
  </con:testStep>
  <con:testStep id="110d46aa-fe58-4586-b95e-348e84edc2bd" name="Test Request - Correct Search wo Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="6fcba7ca-ac6c-4dab-8ecc-b290b7796183" incomingWss="" name="Test Request - Correct Search wo Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring>Item 4</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="50a36a0d-ed41-417a-8fca-22166db33e15" type="SOAP Response"/>
        <con:assertion id="4e29a16d-0ed5-42f8-9217-be174320a073" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="27c42786-1e43-471e-81a5-b3355bdb50c6" type="Not SOAP Fault Assertion"/>
        <con:assertion id="4d71a9cc-7d5c-4314-b59c-abc48a467739" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="cec29160-6565-4318-af15-e4611a717429" name="Test Request - Illegal Search wo Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="ddf834e8-8913-451c-b3b7-c56906ffc9bf" incomingWss="" name="Test Request - Illegal Search wo Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring>Item 7</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="4c9097fd-521f-4a25-9878-14e257a92e58" type="SOAP Response"/>
        <con:assertion id="a3ab627a-e099-4d86-871d-b044e3f4805a" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="ff4b85aa-c6e4-415c-99fa-635028bbda0e" type="Not SOAP Fault Assertion"/>
        <con:assertion id="b6af5b91-6148-416b-8b85-f3f8ba8865b2" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="110d0c5e-e3a3-4ef2-97c3-563dd3468a51" name="Test Request - Empty Search wo. Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="4650945b-b677-42ba-8ea4-eec5cf1fd33b" incomingWss="" name="Test Request - Empty Search wo. Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring/>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="d1233a10-ffa6-41df-9092-d7ec46c4e5fb" type="SOAP Response"/>
        <con:assertion id="aa4291c4-6e3a-47fb-adbe-2738e1c1d655" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="92d6852f-4db3-437b-b016-b60db0165ebf" type="Not SOAP Fault Assertion"/>
        <con:assertion id="8bcf403a-c018-4573-a7b3-3580bd9be6dc" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="af3c1c1c-b0cb-43e1-89e6-ee486566f9df" name="Test Request - Illegal Session wo. Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="d786a017-a03f-4eef-9c30-5be1ef388957" incomingWss="" name="Test Request - Illegal Session wo. Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>6767676767676</sessionid>
 <searchstring>Item 1</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="dbe7c07d-329c-44ba-b6b9-89870e4ddbd1" type="SOAP Response"/>
        <con:assertion id="968e66bd-deb3-41ca-b02f-257b986391cd" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="67a60b72-df4d-4929-a2de-61e2b242044c" type="Not SOAP Fault Assertion"/>
        <con:assertion id="185af2ac-abc7-44fe-8123-5c0a1353d27c" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="b988ab26-a0d4-4221-ae69-2b0c7dcb0064" name="Test Request - SQL Injection SearchString wo. Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="db319b51-6694-4774-9f25-4338abe87709" incomingWss="" name="Test Request - SQL Injection SearchString wo. Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring>Select * from Customers</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="818ba95e-59bf-447a-9535-f6d5addc8598" type="SOAP Response"/>
        <con:assertion id="228e53d2-c004-4de8-8684-36f00bc012d4" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="069e0925-6ed1-4981-8bbf-a7e487a5ba5c" type="Not SOAP Fault Assertion"/>
        <con:assertion id="7d53df55-5db4-474b-8682-3abe59be6866" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="b3a14810-f3a3-42de-9208-9611ccd5037b" name="Test Request - SQL Injection Session wo. Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="5904ee1a-ce3a-4c53-b760-1d1ad1f500bc" incomingWss="" name="Test Request - SQL Injection Session wo. Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>Select * from Customers</sessionid>
 <searchstring>Item 2</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="0cf0e625-11ef-4b63-be5e-bc6d084bda5c" type="SOAP Response"/>
        <con:assertion id="ef39d869-1ff1-43ef-8679-5f8861ea3e46" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="d9571d7a-c86c-41ba-8d8c-86683d4eb8de" type="Not SOAP Fault Assertion"/>
        <con:assertion id="b9d4f349-73d1-4e3b-8e42-1630db838be2" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="19f0c07f-5a6c-4d25-8aaf-340c2f8cd7b8" name="Test Request - Double SessionIDs wo. Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="b72dc616-8e00-4fbd-9581-bdaf3f778e38" incomingWss="" name="Test Request - Double SessionIDs wo. Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
  <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring>Item 2</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="1f840aa7-dc9a-4de7-b156-a0eff2bd38a4" type="SOAP Response"/>
        <con:assertion id="7811aa0a-6408-4886-9c0b-a3a582b3b6fe" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="be302965-0495-4a09-bd0d-921c7f5eaaf5" type="Not SOAP Fault Assertion"/>
        <con:assertion id="0203418f-6749-4fe4-ba47-46c6bdfc28ea" type="XPath Match">
          <con:configuration>
            <path>//faultstring[1]</path>
            <content>Internal server error</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="c2a4081a-0620-4296-bc3e-66f66b1a7f5f" name="Test Request - Login" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>login</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="e9e939b0-a8ec-4fcd-8710-71837676ae8c" incomingWss="" name="Test Request - Login" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:login>
 <username>Login</username>
 <password>Login123</password>
 </sam:login>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="0d8c98b6-2a22-4ca7-9f57-b668b5618b96" type="SOAP Response"/>
        <con:assertion id="badcb433-d58d-4df5-9017-28679b1b70b5" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="ccf82f06-bd18-437f-bed3-e54e3c987b33" type="SOAP Fault Assertion"/>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="3229016a-b45a-4884-aecf-2773bd3de89a" name="Test Request - Illegal Search" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="fab25163-33a0-4396-a47a-18c7438734e8" incomingWss="" name="Test Request - Illegal Search" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
 <searchstring>Item 7</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="b2f01200-7ba5-446e-b66e-13904961efb7" type="SOAP Response"/>
        <con:assertion id="b10e64a4-f455-4222-be60-cf3c1776a0e5" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="602dff6f-c133-4b9e-b492-a11fab36e0a3" type="Not SOAP Fault Assertion"/>
        <con:assertion id="fdbb5d5e-8f42-45d4-b4d6-9eb386db1c22" type="Simple Contains">
          <con:configuration>
            <token>Unknown Search</token>
            <ignoreCase>false</ignoreCase>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="e0c84f5c-8f3c-4ea2-921f-4723221c4567" name="Test Request - Empty Search" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="07659208-1fdd-44e2-83f3-f2969ef1ca45" incomingWss="" name="Test Request - Empty Search" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
 <searchstring/>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="8307e3bc-5623-49e8-81a1-de5b13066827" type="SOAP Response"/>
        <con:assertion id="43d1cbb7-570d-4df9-8ea8-0de524e40123" type="Not SOAP Fault Assertion"/>
        <con:assertion id="877221ba-2fd9-48c8-ad0c-38d03cf1d523" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Unknown Search String</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:assertion id="4c1a91f9-230c-42c1-8dc1-84c0f6a01d23" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="f360dd3e-b45b-4d12-93e8-a66932781b88" name="Test Request - Illegal Session" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="c46bf4ad-5be7-4864-8932-2486a20781da" incomingWss="" name="Test Request - Illegal Session" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>6767676767676</sessionid>
 <searchstring>Item 1</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="a80a02f8-2970-4b7a-a447-ef33701f156a" type="SOAP Response"/>
        <con:assertion id="732d5eaa-3cc3-4f33-83bd-0acacac904c2" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="97ba9313-4b4f-4b2c-9bb3-138fd46b12c9" type="Not SOAP Fault Assertion"/>
        <con:assertion id="1942fb6c-9ab6-42d1-97bb-9780adad8561" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="71debe9a-24bd-4a39-a86d-b7dddfc50a2b" name="Test Request - SQL Injection SearchString" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="338aea04-98ec-4dd9-85de-7b4a8b88e748" incomingWss="" name="Test Request - SQL Injection SearchString" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
 <searchstring>Select * from Customers</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="4a8679fd-3274-4a7c-b84f-aa841d3f920c" type="SOAP Response"/>
        <con:assertion id="2c7b757e-7f85-4a0c-b31e-f61880c556d0" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="7c2610d3-1882-489a-9777-744f1240642f" type="Not SOAP Fault Assertion"/>
        <con:assertion id="988d135a-4f0d-4a88-8710-597656ab3716" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Unknown Search String</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="085a1037-77e6-4bc7-b1ef-7f93be0f2532" name="Test Request - SQL Injection Session" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="9f280f5d-caa2-4f3e-bfdd-068224719ad9" incomingWss="" name="Test Request - SQL Injection Session" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>Select * from Customers</sessionid>
 <searchstring>Item 2</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="40f0d1a9-b029-4fb0-bcbc-975734628bcf" type="SOAP Response"/>
        <con:assertion id="b13cc258-9e93-4f28-94e4-81b04e6c3bd4" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="ada8ad5a-93e7-4f94-8c3a-3c14efb602e9" type="Not SOAP Fault Assertion"/>
        <con:assertion id="3795fab2-7321-4676-bac1-f1f311e2b6f2" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="d6e5aa62-2de5-4ab0-8baa-9e35ba8ad57c" name="Test Request - Double SessionIDs" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="f697e24f-47a7-48a0-b092-a27849cb9178" incomingWss="" name="Test Request - Double SessionIDs" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
	 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
 <searchstring>Item 2</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="1b2feb6a-5cce-46be-a527-e735c869dccd" type="SOAP Response"/>
        <con:assertion id="5f996a7b-affd-4a51-a7f6-b4ed01de1e55" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="9dc9ca2a-bbeb-4019-8d1e-9327f7bf50d1" type="Not SOAP Fault Assertion"/>
        <con:assertion id="477f4579-6f5d-4ca4-b78b-361c62afc485" type="XPath Match">
          <con:configuration>
            <path>//faultstring[1]</path>
            <content>Internal server error</content>
            <allowWildcards>false</allowWildcards>
            <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
            <ignoreComments>false</ignoreComments>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="99d4e9c7-35bb-4fae-a624-92146ff90dda" name="Test Request - logout" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>logout</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="dca6ce42-b7f2-481d-9b8e-058b57b58d5d" incomingWss="" name="Test Request - logout" outgoingWss="">
        <con:settings/>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:logout>
 <sessionid>${Test Request - Login#Response#//sam:loginResponse/sessionid}</sessionid>
 </sam:logout>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="17350191-7e2d-4d84-9102-4720fd1eb00b" type="SOAP Response"/>
        <con:assertion id="0da7ba04-77eb-4e6c-97bf-61822fadf8b0" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="2b3c6073-5c10-4812-93d0-5d45b2b2bbd6" type="XPath Match">
          <con:configuration>
            <path>declare namespace sam='http://www.soapui.org/sample/';
                                    //sam:logoutResponse/sessioninfo</path>
            <content>OK</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="8e278349-0d78-4096-9a71-326c046ff028" name="Test Request - Correct Search after Logout" type="request">
    <con:settings/>
    <con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:interface>ServiceSoapBinding</con:interface>
      <con:operation>search</con:operation>
      <con:request defaultIncomingWss="" defaultOutgoingWss="" id="910c2093-531b-4bdc-bc7b-9f2d6ad82f35" incomingWss="" name="Test Request - Correct Search after Logout" outgoingWss="">
        <con:settings>
          <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
        </con:settings>
        <con:encoding>UTF-8</con:encoding>
        <con:endpoint>http://127.0.0.1:8082/mockServiceSoapBinding</con:endpoint>
        <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sam="http://www.soapui.org/sample/">
 <soapenv:Header/>
 <soapenv:Body>
 <sam:search>
 <sessionid>${Correct Session Property#Session}</sessionid>
 <searchstring>Item 4</searchstring>
 </sam:search>
 </soapenv:Body>
</soapenv:Envelope>]]></con:request>
        <con:assertion id="8b8cdc55-274e-4a83-98ce-3f4703341b44" type="SOAP Response"/>
        <con:assertion id="14cfa966-d4a0-4caf-9c33-045cc0acaaed" name="Schema Compliance" type="Schema Compliance">
          <con:configuration/>
        </con:assertion>
        <con:assertion id="926d8b1a-bb2e-480e-ad4d-0b02b980f0cf" type="Not SOAP Fault Assertion"/>
        <con:assertion id="3cab7b0c-7b4b-4687-88ca-077af3fdbb5a" type="XPath Match">
          <con:configuration>
            <path>//faultstring</path>
            <content>Invalid Session Id</content>
            <allowWildcards>false</allowWildcards>
          </con:configuration>
        </con:assertion>
        <con:credentials>
          <con:username/>
          <con:password/>
          <con:domain/>
          <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
          <con:authType>No Authorization</con:authType>
        </con:credentials>
        <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
        <con:jmsPropertyConfig/>
        <con:wsaConfig mustUnderstand="NONE" version="200508"/>
        <con:wsrmConfig version="1.2"/>
      </con:request>
    </con:config>
  </con:testStep>
  <con:testStep id="55f97dd9-d5aa-4604-9450-bc91b85ffb70" name="Stop Virt Service" type="VirtRunnerTestStep">
    <con:settings/>
    <con:config>
      <url>localhost</url>
      <server>ServiceSoapBinding MockService</server>
      <action>stop</action>
    </con:config>
  </con:testStep>
  <con:properties/>
  <con:reportParameters/>
  <con:breakPoints>
    <con:testStepId>f3e10730-0767-4cb6-aea4-49f80541dcc2</con:testStepId>
    <con:status>NONE</con:status>
    <con:properties/>
  </con:breakPoints>
</con:testCase>
